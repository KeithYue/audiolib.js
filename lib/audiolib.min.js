this.audioLib=(function(t,f){var u=t.Float32Array||Array,b=this;function g(w){var x=new u(w);x.subarray=x.subarray||x.slice;return x}b.Float32Array=g;function q(C,x,z,D,B){this.attack=x||50;this.decay=z||50;this.sustain=D||1;this.release=B||50;this.value=0;var E=this,w=3,y=false,A=[function(){E.value+=1000/E.sampleRate/E.attack;if(E.value>=1){w=1}},function(){E.value-=1000/E.sampleRate/E.decay*E.sustain;if(E.value<=E.sustain){w=2}},function(){E.value=E.sustain},function(){E.value=f.max(0,E.value-1000/E.sampleRate/E.release)}];this.generate=function(){A[w]();return this.value};this.triggerGate=function(F){y=F;w=y?0:3};this.sampleRate=C}function o(){var D=this,w=[];this.velocity=0;this.legato=0;this.retrigger=0;this.polyphony=1;this.activeKeys=[];this.voices=[];this.pitchBend=0;function C(F,G){this.key=F;this.velocity=G;this.noteOff=function(){};this.onKeyChange=function(){};this.changeKey=function(I,H){this.key=I;this.v=H;this.onKeyChange()};this.getFrequency=function(){return D.getFrequencyForKey(this.key)};D.voice.apply(this)}function z(G){var F;for(F=0;F<w.length;F++){if(w[F].key===G){w.splice(F--,1)}}}function E(F,G){z(F);w.push({key:F,velocity:G})}function B(){var F,H,G=[];if(D.legato===0){G=w.slice(0)}else{if(D.legato===1){for(F=0;F<w.length;F++){for(H=0;H<G.length;H++){if(H===w.length-1||(G[H-1].key>w[F].key&&G[H].key<w[F].key)){G.splice(H,0,w[F]);break}}}}else{if(D.legato===2){for(F=0;F<w.length;F++){for(H=0;H<G.length;H++){if(H===w.length-1||(G[H-1].key<w[F].key&&G[H].key>w[F].key)){G.splice(H,0,w[F]);break}}}}}}D.activeKeys=G.slice(-D.polyphony)}function x(){if(!D.voice){return}var G,H,F;if(D.polyphony===1&&D.activeKeys.length>0){G=D.activeKeys.length-1;if(D.voices.length===0){D.voices.push(new C(D.activeKeys[G].key,D.activeKeys[G].velocity))}else{D.voices[0].changeKey(D.activeKeys[G].key,D.activeKeys[G].velocity)}}else{for(H=0;H<D.activeKeys.length;H++){F=false;for(G=0;G<D.voices.length;G++){if(D.voices[G].key===D.activeKeys[H].key){F=true;break}}if(!F){D.voices.push(new C(D.activeKeys[G].key,D.activeKeys[G].velocity))}}}for(G=0;G<D.voices.length;G++){F=false;for(H=0;H<D.activeKeys.length;H++){if(D.voices[G].key===D.activeKeys[H].key){F=true;break}}if(!F){D.voices[G].noteOff();D.voices.splice(G--,1)}}}function y(G,H){var F=D.activeKeys.length;E(G,H);B();x();D.onNoteOn(G,H);if(D.retrigger===0||(F===0&&D.activeKeys.length>0)){D.onTrigger()}}function A(F,G){z(F,G);B();x();D.onNoteOff(F,G);if(D.activeKeys===0){D.onRelease()}}this.onMidi=function(F){switch(F.status){case 9:y(F.data1,F.data2/127);break;case 8:A(F.data1,F.data2/127);break;case 14:D.pitchBend=(F.data1*128+F.data2-8192)/8192;break}};this.getFrequencyForKey=function(F){return 440*f.pow(1.059,F-69)};this.getFrequency=function(){var G=[],F;for(F=0;F<D.activeKeys.length;F++){G.push(D.getFrequencyForKey(D.activeKeys[F].key))}if(G.length>2){return G[0]}return G};this.onTrigger=function(){};this.onRelease=function(){};this.onNoteOn=function(){};this.onNoteOff=function(){};this.voice=null;this.listener=function(F){D.onMidi(F)}}function r(z,A,y,B){var x=this,w=0;x.sampleRate=z;x.stepLength=A||200;x.steps=y||[1,0];x.value=0;x.attack=B||0;x.generate=function(){var I=x.sampleRate/1000*x.stepLength,D=x.steps,F=I*D.length,H,C,G,E,J;if(++w===F){w=0}H=w/F*D.length;C=H%1;H=f.floor(H);G=(H||D.length)-1;E=D[H]-D[G];J=D[H];if(C<x.attack){J-=E-E/x.attack*C}x.value=J;return J};x.triggerGate=function(){w=0}}function n(D,w,A,x){var F=this,y=new g(w),z=w-1,B=A,C=0,E=0;this.volume=F.volume||1;F.sampleRate=D;F.pushSample=function(G){y[B++]=G;E=y[C++]*F.volume;if(B>=z){B=0}if(C>=z){C=0}return E};F.getMix=function(){return E}}function p(C,y,B,x){var E=this,z,A,D;E.delayTime=y||30;E.depth=B||3;E.freq=x||0.1;function w(){z=new g(E.sampleRate*0.1);A=0;var G,F=z.length;for(G=0;G<F;G++){z[G]=0}}E.sampleRate=C;E.osc=new h(C,x);E.calcCoeff=w;E.pushSample=function(G){if(++A>=z.length){A=0}z[A]=G;E.osc.generate();var F=E.delayTime+E.osc.getMix()*E.depth;F*=E.sampleRate/1000;F=A-f.floor(F);while(F<0){F+=z.length}D=z[F];return D};E.getMix=function(){return D};w()}function d(E,B,H){var K=this,z=(!E?44100:E)*2,C=new g(z),D=0,A=0,G=0,J=0,F=f.floor;function y(){A=z/K.samplerate/K.time*1000;G=K.time}function I(L,O,N){var M=O;while(M++!==N){if(M>=z){M=0}C[M]=L}}function x(L){C[D++]+=L;if(D>K.time/1000*K.samplerate){D=0}C[D]=C[D]*K.feedback}function w(M){var L=F(D);if(G!==K.time){y()}D+=A;if(D>=z){D-=z}I(M+C[F(D)]*K.feedback,L,F(D))}this.time=!B?1000:B;this.feedback=0;this.algorithm=0;this.samplerate=E;this.pushSample=function(L){if(this.algorithm===0){x(L)}else{w(L)}J=C[F(D)];return J};this.getMix=function(){return J}}function m(w){var A=new c(w,720.484),z=new c(w,723.431),y=new c(w,1),x=0;this.gain=4;this.master=1;this.sampleRate=w;this.filters=[A,z,y];this.pushSample=function(B){A.pushSample(B);x=A.getMix(1)*this.gain;x=f.atan(x)+x;if(x>0.4){x=0.4}else{if(x<-0.4){x=-0.4}}z.pushSample(x);y.pushSample(z.getMix(0));x=y.getMix(1)*this.master;return x};this.getMix=function(){return x}}(function(w,x){x.Capper=function(A,B){var z=this,y=0;z.sampleRate=A;z.cap=B||1;z.pushSample=function(C){y=C>z.cap?2*z.cap-C:C<-z.cap?-2*z.cap-C:C;return y};z.getMix=function(){return y}};x.Expo=function(z,A){var y=this;sample=0;y.sampleRate=z;y.param=A||0.8;y.pushSample=function(B){sample=(B<0?-f.pow(y.param*2,-B):f.pow(y.param*2,B))/10;return sample};y.getMix=function(){return sample}}}(this,b));function c(A,D,H,G){var J=this,E=[0,0,0,0],x,y,I,B,F=f.sin,z=f.min,C=f.pow;J.cutoff=!D?20000:D;J.resonance=!H?0.1:H;J.samplerate=A;J.type=G||0;function w(){x=2*F(f.PI*z(0.25,J.cutoff/(J.samplerate*2)));y=z(2*(1-C(J.resonance,0.25)),z(2,2/x-x*0.5))}J.pushSample=function(K){if(I!==J.cutoff||B!==J.resonance){w();I=J.cutoff;B=J.resonance}E[3]=K-y*E[2];E[0]=E[0]+x*E[2];E[1]=E[3]-E[0];E[2]=x*E[1]+E[2];E[3]=K-y*E[2];E[0]=E[0]+x*E[2];E[1]=E[3]-E[0];E[2]=x*E[1]+E[2];return E[J.type]};J.getMix=function(K){return E[K||J.type]}}function l(y,z,A){var w=this,x=[0,0];w.cutoff=!z?20000:z;w.resonance=!A?0:A;w.samplerate=y;w.pushSample=function(C){var B=w.cutoff*2/w.samplerate,D=w.resonance+w.resonance/(1-B);x[0]=x[0]+B*(C-x[0]+D*(x[0]-x[1]));x[1]=x[1]+B*(x[0]-x[1]);return x[1]};w.getMix=function(){return x[1]}}function s(B,D,G){var K=this,J=0,A=0,E=f.PI*2,I,z,x,F,H,C;K.cutoff=!D?20000:D;K.resonance=!G?1:G;K.samplerate=B;function y(){I=E*K.cutoff/K.samplerate;z=1-I/(2*(K.resonance+0.5/(1+I))+I-2);x=z*z;F=x+1-2*f.cos(I)*z}K.pushSample=function(w){if(H!==K.cutoff||C!==K.resonance){y();H=K.cutoff;C=K.resonance}J+=(w-A)*F;A+=J;J*=x;return A};K.getMix=function(){return A};y()}function h(z,C){var x=0,B=0,y=f.PI*2,w=new g(1),A;this.frequency=440;if(C){this.frequency=C}this.phaseOffset=0;this.pulseWidth=0.5;this.waveShape=0;this.samplerate=z;this.generate=function(){var G=this.frequency+0,F=this.pulseWidth,E,D=arguments.length;for(E=0;E<D;E++){G+=G*arguments[E]}x=(x+G/this.samplerate/2)%1;B=(x+this.phaseOffset)%1;B=B<F?B/F:(B-F)/(1-F)};this.getMix=function(){return A[this.waveShape]()};this.getPhase=function(){return B};this.reset=function(){x=0};this.setWavetable=function(D){w=D;return true};this.sine=function(){return f.sin(B*y)};this.triangle=function(){if(B<0.5){return 4*B-1}return 3-4*B};this.square=function(){return(B<0.5)?-1:1};this.sawtooth=function(){return 1-B*2};this.invSawtooth=function(){return B*2-1};this.pulse=function(){if(B<0.5){if(B<0.25){return B*8-1}else{return 1-(B-0.25)*8}}return -1};this.wavetable=function(){return w[f.floor(B*w.length)]};A=this.waveShapes=[this.sine,this.triangle,this.pulse,this.sawtooth,this.invSawtooth,this.square]}function j(y,w,B){var x=this,A=[],z;x.sampleRate=y;x.sample=w;x.pitch=B||440;x.delayStart=0;x.delayEnd=0;x.maxVoices=0;x.noteOn=function(H){H=H||x.pitch;var F=H/x.pitch,E=x.sampleRate,G=E*x.delayStart,C=x.sample.length-E*x.delayEnd,D={f:H,p:G,s:F,l:C};A.push(D);return D};x.generate=function(){var C,D;for(C=0;C<A.length;C++){D=A[C];D.p+=D.s;D.p>D.l&&A.splice(C--,1)&&D.onend&&D.onend()}};x.getMix=function(E){var D=0,C;E=E||0;for(C=0;C<A.length;C++){D+=j.interpolate(x.samples[E],A[C].p)}return D};x.load=function(F,C){var D=x.samples=j.splitChannels(F.data,F.channelCount),E;if(C){for(E=0;E<D.length;E++){D[E]=j.resample(D[E],F.sampleRate,1,x.sampleRate,1)}}x.sample=C?j.resample(D,F.sampleRate,1,x.sampleRate,1):D}}j.interpolate=function(w,A){var z=f.floor(A),y=z+1,x=A-z;y=y<w.length?y:0;return w[z]*(1-x)+w[y]*x};j.resample=function(A,E,F,G,D){var y=G/E*D/F,z=A.length,C=f.ceil(z/y),x=new g(C),B,w;for(B=0,w=0;B<z;B+=y){x[w++]=j.interpolate(A,B)}return x};j.splitChannels=function(B,x){var w=B.length,A=w/x,y=[],z,C;for(z=0;z<x;z++){y[z]=new g(A);for(C=0;C<A;C++){y[z][C]=B[z*x+C]}}return y};j.joinChannels=function(x){var y=x.length,w=x[0].length,A=new g(w*y),z,B;for(z=0;z<y;z++){for(B=0;B<w;B++){A[z+B*y]=x[z][B]}}return A};(function(B){function w(H){var J,I=H.length,K={};for(J=0;J<I;J++){K[H[J]]=true}return K}var D=w([256,512,1024,2048,4096,8192,16384]),x=w([48000,44100,22050]),F=String.fromCharCode;function C(N,J,L,K){var I=C.devices,H;for(H in I){if(I.hasOwnProperty(H)&&I[H].enabled){try{return new I[H](N,J,L,K)}catch(M){}}}throw"No audio device available."}function A(H){this.boundTo=H;this.buffers=[];H.activeRecordings.push(this)}A.prototype={add:function(H){this.buffers.push(H)},clear:function(){this.buffers=[]},stop:function(){var H=this.boundTo.activeRecordings,I;for(I=0;I<H.length;I++){if(H[I]===this){H.splice(I--,1)}}},join:function(){var L=0,M=0,J=this.buffers,H,N,K,I=J.length;for(K=0;K<I;K++){L+=J[K].length}H=new g(L);for(K=0;K<I;K++){for(N=0;N<J[K].length;N++){H[M+N]=J[K][N]}M+=J[K].length}return H}};function E(H){this.type=H}E.prototype={record:function(){return new A(this)},recordData:function(J){var K=this.activeRecordings,I,H=K.length;for(I=0;I<H;I++){K[I].add(J)}},writeBuffers:function(M){var I=this.buffers,H=M.length,K,J,L,N;if(I){for(L=0;L<I.length;L++){K=I[L];J=K.length;for(N=0;N<H&&N<J;N++){M[N]+=K[N]}I[L]=K.subarray(N);L>=J&&I.splice(L--,1)}}},writeBuffer:function(I){var H=this.buffers=this.buffers||[];H.push(I);return H.length}};function G(K,O,I,U){U=x[U]?U:44100;I=D[I]?I:U/2;var V=this,R=0,S=null,L=new Audio(),M,N,Q,P,H;function T(Y,W){var ab,aa,X;if(G.backgroundWork){if(window.MozBlobBuilder){X=new MozBlobBuilder();X.append('setInterval(function(){ postMessage("tic"); }, '+W+");");aa=window.URL.createObjectURL(X.getBlob());ab=new Worker(aa);ab.onmessage=function(){Y()};return function(){ab.terminate();window.URL.revokeObjectURL(aa)}}aa=X=+new Date+"";function Z(ac){if(ac.source===window&&ac.data===aa&&X<+new Date){X=+new Date+W;Y()}window.postMessage(aa,"*")}window.addEventListener("message",Z,true);window.postMessage(aa,"*");return function(){window.removeEventListener("message",Z)}}else{ab=setInterval(Y,W);return function(){clearInterval(ab)}}}function J(){if(S){M=L.mozWriteAudio(S);R+=M;if(M<S.length){S=S.subarray(M);return S}S=null}N=L.mozCurrentSampleOffset();Q=Number(N+I*O-R)+0;if(Q>0){P=new g(Q);K&&K(P,V.channelCount);V.writeBuffers(P);V.recordData(P);M=L.mozWriteAudio(P);if(M<P.length){S=P.subarray(M)}R+=M}}L.mozSetup(O,U);H=T(J,20);this.kill=function(){H()};this.activeRecordings=[];this.sampleRate=U;this.channelCount=O;this.type="moz"}G.enabled=true;G.backgroundWork=false;G.prototype=new E("moz");function z(M,N,H,O){O=x[O]?O:44100;H=D[H]?H:4096;var P=this,I=new (window.AudioContext||webkitAudioContext)(),L=I.createJavaScriptNode(H,0,N),K=I.createBufferSource();function J(X){var W=X.outputBuffer,U=W.numberOfChannels,S,Q,R=W.length,Y=W.size,T=new Array(U),V=new g(R*U);for(S=0;S<U;S++){T[S]=W.getChannelData(S)}M&&M(V,U);P.writeBuffers(V);P.recordData(V);for(S=0;S<R;S++){for(Q=0;Q<U;Q++){T[Q][S]=V[S*U+Q]}}}L.onaudioprocess=J;K.connect(L);L.connect(I.destination);this.kill=function(){};this.activeRecordings=[];this.sampleRate=I.sampleRate;this.channelCount=N;this.type="webkit"}z.enabled=true;z.prototype=new E("webkit");function y(N,I,L,K){K=x[K]?K:44100;L=D[L]?bufferSize:8192;var H=this,M;function J(){var O=new g(L*I);N&&N(O,H.channelCount);H.writeBuffers(O);H.recordData(O)}this.kill=function(){clearInterval(M)};this.activeRecordings=[];setInterval(J,L/K*1000);this.sampleRate=K;this.channelCount=I;this.type="dummy"}y.enabled=true;y.prototype=new E("dummy");C.deviceClass=E;C.propertyEnum=w;C.devices={moz:G,webkit:z,dummy:y};C.Recording=A;B.AudioDevice=C}(this));this.AudioDevice.createScheduled=function(z){var A=[],y=0,w;function x(F,D){var B=F.length/D,I=w.chunkSize,C=I*D,H,E,G;y=+new Date;for(E=0;E<B;E+=I){for(H=0;H<A.length;H++){A[H].t-=I;if(A[H].t<=0){A[H].f.apply(A[H].x,A[H].a);A.splice(H--,1)}}G=E*C;z(F.subarray(G,G+C),D)}}w=this.apply(this,[x].concat(Array.prototype.splice.call(arguments,1)));w.schedule=function(D,C,B){A.push({f:D,x:C,a:B,t:((new Date-y)*0.001*this.sampleRate)})};w.chunkSize=1;return w};(function(C,w){var F=String.fromCharCode,E=true,z=false;function x(y,H){return H?F(y&255)+x(y>>8,H-1):""}function D(y,H){return H?D(y>>8,H-1)+F(255-y&255):""}function G(y,H,I){return I?D(y,H):x(y,H)}function B(L,K){var y=L.length,J=y-1,M=0,I=w.pow,H;if(K){for(H=0;H<y;H++){M+=(255-L.charCodeAt(H))*I(256,J-H)}}else{for(H=0;H<y;H++){M+=L.charCodeAt(H)*I(256,H)}}return M}function A(J,y,I,R){var N=w.pow,M=w.floor,O=A.convertFromBinary,T=A.convertToBinary,P=J/8,H=N(2,J),Q=H/2,S=Q-1,K=1/Q,L=1/S;return R?I?y?function(U,V){U=M(U<0?U*Q+H:U*S);return T(U,P,V)}:function(U,V){return T(M(U*S),P,V)}:y?function(U,V){return T(U<0?U+H:U,P,V)}:function(U,V){return T(U,P,V)}:I?y?function(W,V){var U=O(W,V);return U>S?(U-H)*K:U*L}:function(V,U){return O(V,U)*L}:y?function(W,V){var U=O(W,V);return U>S?U-H:U}:function(V,U){return O(V,U)}}A.convertToBinary=G;A.convertFromBinary=B;A.fromFloat32=A(32,E,E,E);A.toFloat32=A(32,E,E,z);A.fromFloat24=A(24,E,E,E);A.toFloat24=A(24,E,E,z);A.fromFloat16=A(16,E,E,E);A.toFloat16=A(16,E,E,z);A.fromFloat8=A(8,E,E,E);A.toFloat8=A(8,E,E,z);A.fromInt32=A(32,E,z,E);A.toInt32=A(32,E,z,z);A.fromInt16=A(16,E,z,E);A.toInt16=A(16,E,z,z);A.fromInt8=A(8,E,z,E);A.toInt8=A(8,E,z,z);A.fromUint32=A(32,z,z,E);A.toUint32=A(32,z,z,z);A.fromUint16=A(16,z,z,E);A.toUint16=A(16,z,z,z);A.fromUint8=A(8,z,z,E);A.toUint8=A(8,z,z,z);C.Binary=A}(this,f));(function(w,B){function C(D){this.data=D}var A=C.prototype={read:function(D){var E=this,F=E.data.substr(0,D);E.skip(D);return F},skip:function(D){var E=this,F=E.data=E.data.substr(D);E.pointer+=D;return F.length},readBuffer:function(J,H,I){var F=this,E="read"+I+H,K=H/8,D=J.length,G=0;while(F.data&&G<D){J[G++]=F[E]()}return G}},z,y;function x(G,E,F){var D=E/8;A["read"+G+E]=function(H){return F(this.read(D),H)}}for(z in B){y=/to([a-z]+)([0-9]+)/i.exec(z);y&&x(y[1],y[2],B[z])}w.Stream=C;C.newType=x}(this,this.Binary));this.PCMData=(function(w,y){function x(z){return(typeof z==="string"?x.decode:x.encode)(z)}x.decodeFrame=function(B,z,A){(new y(B)).readBuffer(A,z,"Float");return A};x.encodeFrame=function(E,B){var D=w["fromFloat"+B],z=E.length,C="",A;for(A=0;A<z;A++){C+=D(E[A])}return C};x.decode=function(Y,X){var J=new y(Y),F=J.read(4),Q=J.readUint32();J=new y(J.read(Q));var L=J.read(4),G=J.read(4),O=J.readUint32(),A=new y(J.read(O)),H=A.readUint16(),V=A.readUint16(),W=A.readUint32(),I=A.readUint32(),R=A.readUint16(),U=R/V,M=O===16?A.readUint16():A.readUint32(),C,E,N,S,P,K,T,z={},D={channelCount:V,bytesPerSample:R/V,sampleRate:I/R,chunks:z,data:P};function B(){C=J.read(4);E=J.readUint32();S=J.read(E);K=z[C]=z[C]||[];if(C==="data"){N=~~(E/U);P=D.data=new (typeof g!=="undefined"?g:Array)(N);x.decodeFrame(S,U*8,P)}else{K.push(S)}X&&(J.data?setTimeout(B,1):X(D))}if(X){J.data?B():X(D)}else{while(J.data){B()}}return D};x.encode=function(Q,O){var M=w.fromUint32,R=w.fromUint16,H=Q.data,A=Q.sampleRate,B=Q.channelCount||1,L=Q.bytesPerSample||1,F=L*8,D=B*L,J=A*D,E=H.length,C=E*L,S=f.pow(2,F-1)-1,z=[],G="",P,N,I,K;z.push("fmt "+M(16)+R(1)+R(B)+M(A)+M(J)+R(D)+R(F));z.push("data"+M(C)+x.encodeFrame(H,F));K=Q.chunks;if(K){for(N in K){if(K.hasOwnProperty(N)){P=K[N];for(I=0;I<P.length;I++){G=P[I];z.push(N+M(G.length)+G)}}}}z=z.join("");z="RIFF"+M(z.length)+"WAVE"+z;O&&setTimeout(function(){O(z)},1);return z};return x}(this.Binary,this.Stream));(function(D,x){var E=x.sin,I=x.cos,H=x.sqrt,B=x.floor,C=x.pow,w=x.ln2,A=x.PI,z=A*2;function y(K,J,L){K.sampleRate=J;K.bufferSize=L;K.bandWidth=0.5*L*J*0.5;K.spectrum=new g(L*0.5);K.real=new g(L);K.imag=new g(L);K.peakBand=K.peak=0;K.getBandFrequency=function(M){return this.bandwidth*M+this.bandwidth*0.5};K.calculateSpectrum=function(){var X=this,M=X.spectrum,U=X.real,P=X.imag,W=0.5*X.bufferSize,O=H,T=L*0.5,S,V,R,Q;for(Q=0;Q<T;Q++){S=U[Q];V=P[Q];R=W*O(S*S+V*V);if(R>X.peak){X.peakBand=Q;X.peak=R}}}}function G(K,J,L){return new G[K](J,L)}function F(K,Q){var J=this,P=Q*Q*0.5,M=new g(P),O=new g(P),L;y(J,K,Q);for(L=0;L<P;L++){M[L]=E(L*z/Q);O[L]=I(L*z/Q)}J.forward=function(V){var aa=this,Y=aa.real,R=aa.imag,X=aa.bufferSize*0.5,T=V.length,W,Z,U,S,ab;for(U=0;U<X;U++){W=Z=0;for(S=0;S<T;S++){W+=O[ab=U*S]*V[S];Z+=M[ab]*V[S]}Y[U]=W;R[U]=Z}return aa.calculateSpectrum()}}D.FourierTransform=G;G.DFT=F}(this,f));b.ADSREnvelope=q;b.MidiEventTracker=o;b.StepSequencer=r;b.AllPassFilter=n;b.Chorus=p;b.Delay=d;b.Distortion=m;b.IIRFilter=c;b.LowPassFilter=l;b.LP12Filter=s;b.Oscillator=h;b.Sampler=j;function a(){}a.prototype={type:"effect",sink:true,source:true,mix:0.5,join:function(){return v.apply(0,[this].concat(Array.prototype.splice.call(arguments,0)))}};function v(){var w=Array.prototype.splice.call(arguments,0),x=w.prototype=v.prototype;for(i in x){if(x.hasOwnProperty(i)){w[i]=x[i]}}return w}(function(w){v.prototype=w;w.pushSample=function(x){var y=this,A,z;for(z=0;z<y.length;z++){A=y[z].mix;x=y[z].pushSample(x)*A+x*(1-A)}return x}}(new a()));function e(x,w,y){this.channelCount=w;this.effects=[];function z(){x.apply(this,y)}z.prototype=x.prototype;while(w--){this.effects.push(new z())}}e.prototype={mix:0.5,append:function(A){var x=this,z=x.channelCount,w=A.length,y,B;for(y=0;y<w;y+=z){for(B=0;B<z;B++){A[y+B]=x.effects[B].pushSample(A[y+B])*x.mix+A[y+B]*(1-x.mix)}}return A},join:function(){return BufferEffectChain.apply(0,[this].concat(Array.prototype.splice.call(arguments,0)))}};(function(B,y,w,x,A){w=b.effects={};function z(C){return new b.BufferEffect(this,C,[].slice.call(arguments,1))}for(y=0;y<B.length;y++){x=B[y];w[x]=b[x];A=w[x].prototype=new a();A.name=A.fxid=x;w[x].createBufferBased=z}}(["AllPassFilter","Chorus","Delay","Distortion","IIRFilter","LowPassFilter","LP12Filter"]));function k(w,x){var y=w[0].toUpperCase()+w.substr(1).toLowerCase();k[w]=x;if(x.decode){b.Sampler.prototype["load"+y]=function(z){this.load.apply(this,[k[w].decode(z)].concat([].slice.call(arguments,1)))}}if(x.encode){b.AudioDevice.Recording.prototype["to"+y]=function(z){return k[w].encode({data:this.join(),sampleRate:this.boundTo.sampleRate,channelCount:this.boundTo.channelCount,bytesPerSample:z})}}return x}k("wav",b.PCMData);b.EffectChain=v;b.EffectClass=a;b.BufferEffect=e;b.codecs=b.Codec=k;b.version="0.4.6";return b}).call(typeof exports==="undefined"?{}:this,this.window||global,Math);